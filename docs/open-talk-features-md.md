# Next.js 15 기반 OpenAI 웹앱 기능 명세서

## 1. 프로젝트 개요

- **프로젝트 이름**: Next.js OpenAI 웹앱
- **목표**: OpenAI API를 활용하여 다양한 AI 기능(챗봇, 특별 역할 AI, 블로그 글 생성, JSON 응답 기반 UI)을 제공하는 웹앱을 제작
- **접근 방식**: 첫 화면에서 카드형 UI를 통해 각 기능으로 진입하며, 기능을 하나씩 추가해 나가는 모듈형 구조
- **사용 기술**:
  - 프론트엔드: Next.js 15, React
  - 백엔드/API: Next.js API 라우트, OpenAI API
  - 스타일링: Tailwind CSS, CSS Modules 또는 Styled Components 등

## 2. 아키텍처 및 구성

### 2.1. 전체 구조

- **클라이언트 사이드 렌더링 (CSR)와 서버 사이드 렌더링 (SSR)의 조합**:
  - 초기 랜딩 페이지: SSR 혹은 SSG로 빠른 로딩 제공
  - 기능별 페이지: 클라이언트 사이드에서 OpenAI API와 통신하며 동적 업데이트
- **API 연동**:
  - Next.js API 라우트를 통해 OpenAI API 호출 (백엔드에서 API 키 관리 및 프록시 역할)
- **상태 관리**:
  - React의 useState, useReducer 혹은 Context API로 페이지별 상태 관리

### 2.2. 폴더 구조 예시

```
/pages
  ├─ index.js          // 랜딩 페이지 (카드형 UI)
  ├─ chatbot.js        // 기본 챗봇 페이지
  ├─ special-ai.js     // 특별 역할 AI 페이지
  ├─ blog-ai.js        // 블로그 글 생성 AI 페이지
  └─ json-ai.js        // JSON 응답 기반 UI 페이지
/pages/api
  └─ openai.js         // OpenAI API 프록시 및 공통 처리 로직
/components
  ├─ Card.js           // 카드형 UI 컴포넌트
  ├─ ChatWindow.js     // 챗봇 대화창 컴포넌트
  ├─ InputArea.js      // 입력 폼 컴포넌트 (공통)
  └─ LoadingSpinner.js // 로딩 표시 컴포넌트
/styles
  └─ globals.css       // 글로벌 스타일 및 Tailwind CSS 적용
```

## 3. 기능별 상세 명세

### 3.1. 랜딩 페이지 (홈)

**목표**: 사용자에게 전체 기능 소개 및 각 기능으로 진입할 수 있는 카드형 UI 제공

**주요 구성 요소**:
- 헤더: 로고, 앱 이름, 간단한 설명
- 카드 목록:
  - 각 카드에는 기능 제목, 아이콘/이미지, 간단한 설명, "바로가기" 버튼
- 푸터: 저작권, 연락처 정보 등

**상세 기능**:
- 반응형 디자인: 데스크탑, 태블릿, 모바일 모두에서 최적화된 카드 레이아웃
- 애니메이션: 카드 hover 효과, 클릭 시 부드러운 전환 효과
- 네비게이션: 각 카드 클릭 시 해당 기능 페이지로 라우팅

**예시 카드 항목**:
- 기본 챗봇: "OpenAI와 실시간 대화를 즐겨보세요."
- 특별 역할 AI: "특정 역할로 맞춤형 답변을 제공하는 AI."
- 블로그 글 생성: "주제에 맞는 블로그 글을 자동으로 작성해드립니다."
- JSON 응답 UI: "AI 응답을 JSON 형태로 받아 UI에 표시합니다."

### 3.2. 기능 1: 기본 챗봇

**목표**: 사용자와 기본적인 대화를 할 수 있는 챗봇 제공

**주요 구성 요소**:
- 대화창 (ChatWindow): 대화 내용 표시 영역 (챗 버블, 타임스탬프 포함)
- 입력 영역 (InputArea): 사용자가 메시지를 입력할 수 있는 텍스트 입력 필드 및 전송 버튼
- API 통신: 사용자 메시지를 OpenAI API로 전송하여 응답 받음

**상세 기능**:
- 실시간 대화: 입력 후 전송 시, 로딩 스피너와 함께 AI 응답 대기
- 대화 히스토리 관리: 페이지 내에서 대화 내용 상태 관리 (메모리 혹은 localStorage 활용 가능)
- 에러 처리: API 호출 실패 시 사용자에게 적절한 오류 메시지 표시

**API 요청 예시 (Next.js API 라우트)**:

```javascript
// pages/api/openai.js
export default async function handler(req, res) {
  const { prompt } = req.body;
  try {
    const response = await fetch('https://api.openai.com/v1/chat/completions', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${process.env.OPENAI_API_KEY}`,
      },
      body: JSON.stringify({
        model: 'gpt-4o',
        messages: [{ role: 'user', content: prompt }],
      }),
    });
    const data = await response.json();
    res.status(200).json(data);
  } catch (error) {
    res.status(500).json({ error: 'API 호출 실패' });
  }
}
```

### 3.3. 기능 2: 특별 역할을 하는 AI

**목표**: AI에게 특정 역할(예: 상담사, 코치, 번역가 등)을 부여하여 맞춤형 답변을 제공

**주요 구성 요소**:
- 역할 선택 드롭다운: 미리 정의된 역할 목록(예: "상담사", "코치", "역사 전문가" 등)
- 대화창 및 입력 영역: 기본 챗봇과 유사한 인터페이스
- 프롬프트 전처리: 선택한 역할에 따라 시스템 메시지(예: "너는 전문 상담사이다.") 추가

**상세 기능**:
- 역할 선택: 사용자가 드롭다운을 통해 역할 선택 후, 대화 시작
- 프롬프트 조합: 시스템 메시지와 사용자의 메시지를 조합하여 OpenAI API 호출
- 대화 히스토리: 역할별 대화 히스토리 관리 (페이지 리셋 시 역할 초기화)
- 유연한 역할 추가: 추후 관리자 페이지 등에서 역할 추가 가능하도록 설계 고려

**API 요청 시 시스템 메시지 예시**:

```javascript
const messages = [
  { role: 'system', content: '너는 전문 상담사이다. 사용자의 질문에 친절하고 자세하게 답변해줘.' },
  { role: 'user', content: userMessage }
];
```

### 3.4. 기능 3: 블로그 글 써주는 AI

**목표**: 사용자가 입력한 주제나 키워드를 기반으로 블로그 글(개요, 본문 등)을 생성

**주요 구성 요소**:
- 주제 입력 폼: 제목, 키워드, 원하는 글의 길이 등을 입력할 수 있는 폼
- 생성 버튼: 입력한 내용을 바탕으로 글 생성 요청
- 결과 표시 영역: 생성된 글을 포맷팅하여 보여줌 (헤드라인, 단락 등)

**상세 기능**:
- 입력 검증: 필수 항목(제목, 키워드 등) 누락 시 에러 메시지 표시
- 로딩 상태: 글 생성 요청 시 로딩 스피너 표시
- 포맷팅 옵션: 간단한 마크다운 렌더링 혹은 HTML 포맷팅 적용
- API 호출: OpenAI API에 주제 및 조건을 반영한 프롬프트 전송

**프롬프트 예시**:
```
"다음 주제에 대해 블로그 글을 작성해줘: [제목/키워드]. 글은 [길이] 분량으로 구성하고, 서론, 본론, 결론 구조로 작성해줘."
```

### 3.5. 기능 4: AI 답변을 JSON으로 받아 UI로 답변하는 기능

**목표**: OpenAI의 응답을 JSON 형식으로 받아 파싱한 후, 각 데이터(예: 제목, 본문, 요약 등)를 UI에 별도 컴포넌트로 표시

**주요 구성 요소**:
- JSON 응답 요청 폼: 사용자가 질문 혹은 주제를 입력
- API 호출 및 JSON 파싱: OpenAI API로부터 JSON 형태의 응답을 받고 파싱
- 결과 표시 컴포넌트: JSON의 각 필드(예: title, content, summary)를 UI 요소로 배치

**상세 기능**:
- JSON 구조 정의: API 호출 시, 명시적으로 JSON 형식을 요청하거나 프롬프트에 "JSON으로 답변해줘" 포함
- 에러 및 파싱 처리: 올바르지 않은 JSON 응답 시 오류 처리 및 재시도 기능
- UI 컴포넌트 구성:
  - 제목: 큰 폰트로 표시
  - 본문: 일반 텍스트 또는 마크다운 렌더링
  - 요약: 별도 강조 영역으로 표시
- 데이터 업데이트: 새 요청 시 이전 데이터 클리어 및 새로운 JSON 데이터 렌더링

**API 프롬프트 예시**:
```
"사용자가 입력한 주제에 대해, 아래 JSON 형식으로 답변해줘:
{
  'title': '...',
  'content': '...',
  'summary': '...'
}"
```

## 4. 공통 기능 및 고려사항

### 4.1. API 연동 및 보안

**API 키 관리**:
- Next.js API 라우트 내에서 환경 변수(process.env.OPENAI_API_KEY)를 사용하여 안전하게 관리
- 클라이언트 측에서는 API 키 노출 방지

**에러 처리**:
- API 호출 실패, 타임아웃, 네트워크 문제 등 각종 오류에 대한 사용자 안내 및 재시도 옵션 제공
- 콘솔 로그 및 서버 로그를 통해 디버깅 정보 기록

### 4.2. 사용자 경험(UX)

**로딩 상태 및 피드백**:
- API 호출 시 로딩 스피너 또는 진행 상태 표시
- 성공, 실패 메시지에 대한 명확한 시각적 피드백

**반응형 디자인**:
- 모든 화면 크기(데스크탑, 태블릿, 모바일)에 최적화된 레이아웃

**접근성**:
- 시멘틱 태그, ARIA 속성 등을 활용하여 접근성 고려

### 4.3. 상태 관리 및 캐싱

**대화 히스토리, 생성된 글 등**:
- 페이지별 혹은 세션별 상태 관리
- 필요 시 localStorage나 sessionStorage 활용하여 데이터 보존

**성능 최적화**:
- 불필요한 재렌더링 최소화, API 응답 캐싱 고려

### 4.4. 라우팅 및 페이지 전환

**Next.js 내장 라우팅 활용**:
- next/link 컴포넌트를 사용하여 페이지 간 전환 최적화

**페이지 애니메이션**:
- CSS Transition 혹은 Framer Motion을 활용한 부드러운 전환 효과

## 5. 개발 및 배포 계획

**개발 단계**:
1. 랜딩 페이지 및 기본 UI 컴포넌트 제작
2. 기능 1 (기본 챗봇) 개발 및 테스트
3. 기능 2 (특별 역할 AI) 추가 및 역할별 프롬프트 테스트
4. 기능 3 (블로그 글 생성) 구현 및 마크다운/HTML 포맷팅 검증
5. 기능 4 (JSON 응답 기반 UI) 구현 및 JSON 파싱 로직 강화

**테스트**:
- 단위 테스트, 통합 테스트, 사용자 경험 테스트 진행

**배포**:
- Vercel 등 Next.js 최적화된 호스팅 플랫폼 활용

## 6. 결론

이 명세서는 Next.js 15와 OpenAI API를 활용하여 단계별로 AI 기능을 확장하는 웹앱 개발을 위한 전반적인 설계 가이드입니다. 프로젝트 진행 시 기능별 상세 요구사항 및 피드백에 따라 유연하게 수정 및 보완할 수 있습니다. 